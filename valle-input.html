<link rel="import" href="../polymer/polymer-element.html">

<dom-module id="valle-input">
  <template>

    <style>

      :host {
        display: inline-block;
        position: relative;
        overflow: hidden;
      }

      .visual-hidden {
        position: absolute;
        left: -10000px;
      }

    </style>

    <label id="inputLabel">[[label]]</label>

    <input
      id="input"
      type=[[type]]
      placeholder=[[placeholder]]
      pattern=[[RegEx]]
      aria-labelledby="inputLabel"
      aria-describedby="description"
    >

    <template is="dom-if" if={{_isNoError(helpertext,error)}}>
      <small id="description">[[helpertext]]</small>
    </template>

    <template is="dom-if" if=[[error]]>
      <span role="alert" id="description">
        [[errortext]]<small class="visual-hidden">: [[helpertext]]</small>
      </span>
    </template>

  </template>

  <script>
    class valleInput extends Polymer.Element {

      static get is() { return 'valle-input'; }

      _isNoError(helpertext, error) {
        return helpertext && !error;
      }

      _toogleRequired(required) {
        required
        ? this.$.input.setAttribute('aria-required', true)
        : this.$.input.removeAttribute('aria-required')
      }

      _toogleDisabled(disabled) {
        disabled
        ? this.$.input.setAttribute('disabled', true)
        : this.$.input.removeAttribute('disabled')
      }

      static get properties() {
        return {
          label: String,
          type: {
            type: String,
            value: "text"
          },
          placeholder: String,
          helpertext: String,
          maxlength: Number,
          errortext: String,
          pattern: String,
          error: {
            type: Boolean,
            value: false,
            reflectToAttribute: true
          },
          required: {
            type: Boolean,
            value: false,
            reflectToAttribute: true,
            observer: '_toogleRequired'
          },
          disabled: {
            type: Boolean,
            value: false,
            reflectToAttribute: true,
            observer: '_toogleDisabled'
          }
        };
      }
    }

    window.customElements.define(valleInput.is, valleInput);
  </script>
</dom-module>
